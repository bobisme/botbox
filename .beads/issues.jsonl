{"id":"bd-110","title":"Review eval: validate multi-agent code review lifecycle","description":"Epic tracking the review eval levels (R1-R4). Validates that agents can request reviews, reviewers can find bugs and vote, authors can respond to feedback, and the full review loop works end-to-end. See eval-review.md for the full plan.","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-31T13:46:37.318264481Z","created_by":"bob","updated_at":"2026-01-31T23:41:56.484905685Z","closed_at":"2026-01-31T23:41:56.484869988Z","close_reason":"All levels complete. R1: 65/65 (100%), R2: 65/65 (100%), R3: 60/65 (92%), R4: 95/95 (100%). 21 runs total across 5 eval types. Framework validated.","source_repo":".","compaction_level":0,"original_size":0,"labels":["epic","eval","review"]}
{"id":"bd-110.1","title":"R1: Reviewer agent eval — find bugs, comment, vote","description":"Standalone reviewer eval. Seed code with intentional issues (bug, quality issue, clean code). Create crit review, run reviewer agent, score on 65-point rubric. COMPLETE: Run 1 (v1 prompt) 51/65 (78%), Run 2 (v2 prompt) 61/65 (94%), Run 3 (v2 + fixed fixture) 65/65 (100%). v2 prompt (clippy, web search, severity levels) is the baseline. Fixture A v2 (OnceLock + role-based match) is the canonical fixture.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-31T13:46:44.595419858Z","created_by":"bob","updated_at":"2026-01-31T14:40:22.397089925Z","closed_at":"2026-01-31T13:46:44.595419858Z","source_repo":".","compaction_level":0,"original_size":0,"labels":["eval","review"],"dependencies":[{"issue_id":"bd-110.1","depends_on_id":"bd-110","type":"parent-child","created_at":"2026-01-31T13:46:44.595419858Z","created_by":"bob","metadata":"{}","thread_id":""}]}
{"id":"bd-110.2","title":"R2: Author response eval — handle reviewer comments","description":"Seed a crit review with pre-written reviewer comments (from an R1 run or manually authored). Run the dev agent loop. Score whether it correctly categorizes each comment and takes the right action: fix (make code change, reply 'Fixed in <change>'), address (explain why current approach is correct), or defer (create bead, reply 'Filed <bead-id>'). Key question: can the agent distinguish 'must fix' from 'won't fix' from 'good idea, later'?","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-31T13:46:51.158777197Z","created_by":"bob","updated_at":"2026-01-31T16:06:20.074517072Z","closed_at":"2026-01-31T16:06:20.074493067Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"labels":["eval","review"],"dependencies":[{"issue_id":"bd-110.2","depends_on_id":"bd-110","type":"parent-child","created_at":"2026-01-31T13:46:51.158777197Z","created_by":"bob","metadata":"{}","thread_id":""},{"issue_id":"bd-110.2","depends_on_id":"bd-110.1","type":"blocks","created_at":"2026-01-31T13:47:10.534432846Z","created_by":"bob","metadata":"{}","thread_id":""}]}
{"id":"bd-110.3","title":"R3: Full review loop — author + reviewer coordination","description":"Two agents coordinating across iterations: (1) dev agent finishes work, creates crit review, announces on botbus, (2) reviewer picks up review, comments, blocks, (3) dev agent sees block, fixes issue, re-requests review, (4) reviewer verifies fix, LGTMs, (5) dev agent merges. Tests the full back-and-forth. Scoring combines R1 (reviewer quality) and R2 (author response) plus coordination mechanics.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-31T13:46:57.137852523Z","created_by":"bob","updated_at":"2026-01-31T16:06:23.033708601Z","closed_at":"2026-01-31T16:06:23.033683985Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"labels":["eval","review"],"dependencies":[{"issue_id":"bd-110.3","depends_on_id":"bd-110","type":"parent-child","created_at":"2026-01-31T13:46:57.137852523Z","created_by":"bob","metadata":"{}","thread_id":""},{"issue_id":"bd-110.3","depends_on_id":"bd-110.2","type":"blocks","created_at":"2026-01-31T13:47:10.576085120Z","created_by":"bob","metadata":"{}","thread_id":""}]}
{"id":"bd-110.4","title":"R4: Integration — worker loop + review + merge end-to-end","description":"Full dev-agent architecture running end-to-end: dev agent triages inbox/beads, dispatches work (sequential or parallel), workers complete tasks, dev agent creates crit reviews, reviewer reviews, dev agent handles feedback, dev agent merges approved work. Scoring combines worker loop (248 pts), review (65 pts), and coordination mechanics.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-31T13:47:02.404871947Z","created_by":"bob","updated_at":"2026-01-31T17:33:51.952337557Z","closed_at":"2026-01-31T17:33:51.952289177Z","close_reason":"R4-1 complete: 89/95 (94%) EXCELLENT — full lifecycle validated","source_repo":".","compaction_level":0,"original_size":0,"labels":["eval","review"],"dependencies":[{"issue_id":"bd-110.4","depends_on_id":"bd-110","type":"parent-child","created_at":"2026-01-31T13:47:02.404871947Z","created_by":"bob","metadata":"{}","thread_id":""},{"issue_id":"bd-110.4","depends_on_id":"bd-110.3","type":"blocks","created_at":"2026-01-31T13:47:10.608880939Z","created_by":"bob","metadata":"{}","thread_id":""}]}
{"id":"bd-122","title":"E2E: sync lifecycle","description":"Tests 4+5 from testing.md — tamper version marker, verify stale detection, sync, verify content preservation","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-29T18:39:18.861195063Z","created_by":"bob","updated_at":"2026-01-29T18:42:48.498617447Z","closed_at":"2026-01-29T18:42:48.498603861Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-123","title":"Write agent-loop.sh end-to-end test","description":"The agent-loop.sh script in scripts/ needs manual or integration testing. Verify: agent lease claim/release, has_work() function, clean exit on no work, cleanup trap. May need mock botbus/br for CI.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-29T17:22:47.055798611Z","created_by":"bob","updated_at":"2026-02-02T16:57:58.424357394Z","closed_at":"2026-02-02T16:57:58.424330203Z","close_reason":"Superseded by eval framework — 27 eval runs (R1-R9) cover agent-loop.sh e2e behavior including claim/release, has_work(), cleanup, crash recovery (R9 99%), and parallel dispatch (R6 99%).","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-138","title":"R8: Adversarial review eval — subtle, hard-to-find bugs","description":"Reviewer agent given code with subtle, hard-to-find bugs that require deep reasoning: race conditions in concurrent code, edge cases in error recovery paths, TOCTOU vulnerabilities, integer overflow in size calculations, incorrect lifetime assumptions. Tests the ceiling of review quality beyond obvious issues like path traversal. Scoring: true positive rate on subtle bugs, false positive rate, severity calibration, evidence quality (does reviewer cite specific execution scenarios?).","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-31T23:42:30.342616553Z","created_by":"bob","updated_at":"2026-02-01T19:22:50.278012796Z","closed_at":"2026-02-01T19:22:50.277939088Z","source_repo":".","compaction_level":0,"original_size":0,"labels":["eval"],"dependencies":[{"issue_id":"bd-138","depends_on_id":"bd-ppt","type":"blocks","created_at":"2026-01-31T23:42:40.685431804Z","created_by":"bob","metadata":"{}","thread_id":""}],"comments":[{"id":5,"issue_id":"bd-138","author":"Bob","text":"v2 fixture + rubric implemented: 7-file multi-file fixture, cross-file reasoning category (5pts), FP resistance reduced (10→5pts). Files changed: r8-setup.sh, r8-run.sh, eval-review.md, eval-results/README.md. Next: run setup to verify cargo check/clippy, then execute Opus + Sonnet runs.","created_at":"2026-02-01T19:05:07Z"}]}
{"id":"bd-13m","title":"Run Level 2 eval: agent task execution with protocol compliance scoring","description":"Execute first Level 2 behavioral evaluation.\n\nSteps:\n1. Create eval environment in /tmp with botbox init\n2. Seed with simple task (hello world endpoint)\n3. Spawn agent with minimal prompt\n4. Observe behavior, collect tool outputs\n5. Score using rubric (critical steps: claim/start/finish/release/sync)\n6. Document findings: protocol compliance, work quality, gaps\n7. Update eval-proposal.md or create eval-results/ with findings\n\nGoal: Validate that AGENTS.md enables protocol-compliant behavior in practice.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-29T20:33:05.730919055Z","created_by":"bob","updated_at":"2026-01-29T20:38:45.129884958Z","closed_at":"2026-01-29T20:38:45.129861214Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-14y","title":"add cli, tui to type of project selection in botbox cli","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-31T21:06:34.989501637Z","created_by":"bob","updated_at":"2026-01-31T21:09:06.517491130Z","closed_at":"2026-01-31T21:09:06.517456154Z","close_reason":"Added 'cli' and 'tui' to PROJECT_TYPES in init.mjs. Now supports all 6 types: api, cli, frontend, library, monorepo, tui.","source_repo":".","compaction_level":0,"original_size":0,"labels":["cli"]}
{"id":"bd-1c5","title":"Add bead title to worker-loop announcements","description":"Update worker-loop.md task-claim and task-done announcement templates to include the bead title.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-01T22:34:34.203498408Z","created_by":"bob","updated_at":"2026-02-01T22:45:08.809753985Z","closed_at":"2026-02-01T22:45:08.809730681Z","close_reason":"Completed","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":18,"issue_id":"bd-1c5","author":"Bob","text":"Updated worker-loop.md task-claim/task-done announcement templates to include bead titles.","created_at":"2026-02-01T22:45:05Z"}]}
{"id":"bd-1ed","title":"Update report-issue.md: check if lead agent is online, spawn if not","description":"report-issue.md currently stops at \"post to the project channel and return to your work.\" It should add a step to check if the receiving project's dev agent is online and spawn it if not.\n\n## New steps (after posting to channel)\n\n5. Check if the lead agent is running:\n   bus check-claim --agent \\$AGENT \"agent://<lead-agent>\"\n6. If not running, spawn it:\n   botty spawn --name <lead-agent> -- bash scripts/dev-loop.sh <project> <lead-agent>\n\nThe lead agent name and project info are already extracted from the #projects registry in step 1.\n\n## Notes\n\n- This is the manual fallback. Once botbus hooks ship (bd-2km), the spawn happens automatically on bus send. But agents should still do this check as a belt-and-suspenders measure.\n- Same pattern already exists in dev-loop.sh for spawning reviewers.\n- botty spawn may not be available in all environments — skip gracefully.\n\n## Acceptance criteria\n\n- report-issue.md includes check-and-spawn steps\n- The steps use the lead agent name from the #projects registry (not hardcoded)\n- Graceful fallback if botty is not available","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-02T16:03:45.940635901Z","created_by":"bob","updated_at":"2026-02-02T16:06:37.357536427Z","closed_at":"2026-02-02T16:06:37.357507904Z","close_reason":"Completed","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":49,"issue_id":"bd-1ed","author":"Bob","text":"Starting: adding spawn-if-offline steps to report-issue.md","created_at":"2026-02-02T16:06:08Z"},{"id":51,"issue_id":"bd-1ed","author":"Bob","text":"Done: added step 5 (check if lead agent is online, spawn via botty if not). Also updated step 1 to use bus history instead of bus inbox for registry queries.","created_at":"2026-02-02T16:06:37Z"}]}
{"id":"bd-1gy","title":"R8v2: update results tables and CLAUDE.md eval count","description":"After both runs: add R8-2 and R8-3 rows to eval-review.md Results table, eval-results/README.md Runs table. Update CLAUDE.md eval count. Add individual report links.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-01T19:08:18.348542476Z","created_by":"bob","updated_at":"2026-02-01T19:22:33.203975072Z","closed_at":"2026-02-01T19:22:33.203906624Z","source_repo":".","compaction_level":0,"original_size":0,"labels":["eval"],"dependencies":[{"issue_id":"bd-1gy","depends_on_id":"bd-138","type":"blocks","created_at":"2026-02-01T19:08:26.496913041Z","created_by":"bob","metadata":"{}","thread_id":""},{"issue_id":"bd-1gy","depends_on_id":"bd-36m","type":"blocks","created_at":"2026-02-01T19:08:30.730497977Z","created_by":"bob","metadata":"{}","thread_id":""},{"issue_id":"bd-1gy","depends_on_id":"bd-fxk","type":"blocks","created_at":"2026-02-01T19:08:30.760864513Z","created_by":"bob","metadata":"{}","thread_id":""}]}
{"id":"bd-1jk","title":"Fix br label command syntax in groom.md","description":"Review cr-xvwo identified critical errors in packages/cli/docs/groom.md:\n\n- Line 16: Shows 'br label create <name>' which doesn't exist, and wrong syntax for 'br label add'\n- Line 79: Same issue - references non-existent 'br label create <name>'\n\nCorrect syntax is:\n- 'br label add -l <label> <issue-id>' (creates label implicitly if it doesn't exist)\n- No 'br label create' command exists\n\nFix all references throughout the document to use correct syntax.\n\nAcceptance criteria:\n- All instances of 'br label create' removed\n- All instances of 'br label add <bead-id> <label>' corrected to 'br label add -l <label> <bead-id>'\n- Document accurately reflects actual br command behavior\n\nTesting: Review the updated doc for accuracy against 'br label --help' output.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-01T23:40:31.666788909Z","created_by":"bob","updated_at":"2026-02-02T16:57:48.342242534Z","closed_at":"2026-02-02T16:57:48.342218389Z","close_reason":"Completed","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":54,"issue_id":"bd-1jk","author":"botbox-dev","text":"Fixed triage.md line 27: removed non-existent 'br label create' command, corrected 'br label add' syntax to use '-l <label> <bead-id>' format. groom.md was already correct. No other files had wrong syntax.","created_at":"2026-02-02T16:57:48Z"}]}
{"id":"bd-1jp","title":"E2E: existing repo clone and init","description":"Test 3 from testing.md — clone botcrit into /tmp, run botbox init, verify no clobbering","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-29T18:39:18.848612765Z","created_by":"bob","updated_at":"2026-01-29T18:42:48.498968565Z","closed_at":"2026-01-29T18:42:48.498955330Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-1pe","title":"botbox sync should update managed section even when docs are unchanged","description":"sync checks doc content hashes and exits early with 'Already up to date' when docs haven't changed. But the managed section is rendered from templates.mjs, which can change independently. Template changes (e.g., identity section, workspace claim URI) don't trigger a managed section update. Fix: either include templates.mjs in the version hash, or always regenerate the managed section and compare.","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-30T16:57:27.959057530Z","created_by":"bob","updated_at":"2026-02-02T00:14:09.012315039Z","closed_at":"2026-02-02T00:14:09.012292798Z","close_reason":"Completed","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":34,"issue_id":"bd-1pe","author":"Bob","text":"Grooming: Acceptance criteria: 'botbox sync' must regenerate managed section even when doc content unchanged. Testing: modify templates.mjs without changing docs, run sync, verify AGENTS.md updated. Implementation approach: remove early exit when docs unchanged, or include template version in hash.","created_at":"2026-02-01T23:45:05Z"},{"id":35,"issue_id":"bd-1pe","author":"Bob","text":"Progress: Fixed sync.mjs to always regenerate managed section. Now testing the fix.","created_at":"2026-02-01T23:45:52Z"},{"id":36,"issue_id":"bd-1pe","author":"Bob","text":"Resolved conflict in .beads/issues.jsonl in workspace red-forge. Workspace is clean and ready for review. Review cr-1d5x pending with bronze-beacon.","created_at":"2026-02-01T23:49:57Z"},{"id":33,"issue_id":"bd-1pe","author":"Bob","text":"Review feedback addressed:\n- th-a7o0 (MEDIUM): Added --check validation for stale managed section. Now sync --check throws when managed section is stale even if docs are current.\n- th-j7n2 (INFO): Won't fix - inline comparison is intentional for simplicity.\n- th-4lsq (LOW): Added test case for --check with stale managed section.\nAll tests pass (8/8). Re-requesting review.","created_at":"2026-02-01T23:56:32Z"},{"id":37,"issue_id":"bd-1pe","author":"Bob","text":"Addressed all review feedback from cr-1d5x:\n\nHIGH issues fixed:\n- th-j5ah: Moved --check validation to after both doc and managed section checks, before any writes\n- th-r375: --check is now truly read-only, throws before any writeFileSync calls\n- th-a7o0: --check now validates both doc and managed section staleness\n\nMEDIUM issue fixed:\n- th-4lsq: Added test case for --check with stale managed section\n\nLOW issue fixed:\n- th-tlnr: Added console output for managed-only updates\n\nAll tests pass. Re-requesting review.","created_at":"2026-02-02T00:01:45Z"},{"id":38,"issue_id":"bd-1pe","author":"Bob","text":"Re-requested review cr-1d5x after applying all fixes. Issues addressed: (1) --check validation moved to line 43, before any writes, checking BOTH docs and managed section. (2) Test added at lines 134-162 for --check with stale managed section. (3) Console output added at line 73 for managed-only updates. All 8 tests pass. Waiting for re-review.","created_at":"2026-02-02T00:04:59Z"},{"id":39,"issue_id":"bd-1pe","author":"Bob","text":"Responded to review cr-1d5x feedback. Clarified to reviewers that fixes are in workspace /home/bob/src/botbox/.workspaces/red-forge/, not project root. All fixes are implemented: sync.mjs lines 28-40 (staleness checks), line 43 (--check validation before writes), test at lines 134-162. All 8 tests pass in workspace.","created_at":"2026-02-02T00:06:29Z"},{"id":40,"issue_id":"bd-1pe","author":"Bob","text":"Responded to review cr-1d5x with evidence that all fixes are implemented in workspace .workspaces/red-forge/.\n\nIssue: Reviewer (phantom-tower) was reading project root (55 lines, unchanged) instead of workspace (76 lines, refactored). Added clarifying comments to threads th-a7o0, th-j5ah, th-r375, th-4lsq with:\n- Line-by-line breakdown of fix implementation\n- Test verification (all 8 tests pass)\n- Reminder that review protocol evaluates workspace content, not project root\n\nWaiting for reviewer to re-evaluate using workspace content. Review currently BLOCKED by botbox-dev (vote), though phantom-tower is the active commenter. Review status: 1 block (botbox-dev), 1 LGTM (phantom-tower).","created_at":"2026-02-02T00:08:32Z"},{"id":41,"issue_id":"bd-1pe","author":"Bob","text":"Review feedback addressed. Root cause was stale jj workspace (needed 'jj workspace update-stale'). All fixes were already in workspace files but not visible to jj until update. Re-described commit as xwwlsvol/0 (338d3602), replied to 5 blocking threads (th-j5ah, th-r375, th-a7o0, th-tlnr, th-4lsq), re-requested review from botbox-dev and phantom-tower. Workspace: red-forge at /home/bob/src/botbox/.workspaces/red-forge/","created_at":"2026-02-02T00:11:32Z"},{"id":42,"issue_id":"bd-1pe","author":"Bob","text":"Completed by crystal-anchor. Review cr-1d5x merged with commit fe839efa.","created_at":"2026-02-02T00:14:05Z"}]}
{"id":"bd-1pp","title":"UX test: subagent reads AGENTS.md and answers workflow questions","description":"Spawn a subagent in a fresh botbox-initialized repo. Have them read AGENTS.md and answer questions about the workflow to validate doc clarity and completeness.\n\nSteps:\n1. Create fresh test repo with botbox init\n2. Spawn subagent in that directory\n3. Ask them to read AGENTS.md\n4. Ask non-leading questions about: identity, triage, starting work, cross-project feedback, reviews, tools\n5. Evaluate their understanding\n6. Write report of findings\n7. Create ux-test.md documenting this testing methodology","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-29T19:47:54.813706644Z","created_by":"bob","updated_at":"2026-01-29T19:50:25.957862776Z","closed_at":"2026-01-29T19:50:25.957834984Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-1vm","title":"Add --seed-work flag to botbox init for initial bead creation","description":"Add a flag/option to botbox init that seeds initial beads by: (1) registering the project on botbus (botbus send projects ... following the convention of existing project registrations), (2) scouting the repo for spec files, README, source structure, and (3) creating beads for initial work items found. Reference: terseid project has bd-3am (review spec.md and create beads) and bd-6z5 (register project on botbus) as examples of what this should automate.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-30T17:03:00.203110324Z","created_by":"bob","updated_at":"2026-02-02T17:00:24.064934818Z","closed_at":"2026-02-02T17:00:24.064907927Z","close_reason":"Completed","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":55,"issue_id":"bd-1vm","author":"botbox-dev","text":"Completed: Added --seed-work flag to botbox init. Scans for spec files (spec.md, SPEC.md, specification.md, design.md), README.md, and src/ directory. Creates targeted beads for each finding, or a generic 'Scout project' fallback bead if nothing found. Uses br create with --actor/--owner flags. Gracefully skips if br not installed or beads not in tools. 3 new tests added (spec detection, fallback bead, skip-without-beads). All 57 tests pass, no new lint errors. Note: botbus registration (part 1 of original description) was already implemented in bd-29l.","created_at":"2026-02-02T17:00:20Z"}]}
{"id":"bd-1ws","title":"E2E: fresh repo non-interactive init","description":"Test 1 from testing.md — create tmp repo, run botbox init with all CLI flags, verify outputs, doctor, sync --check","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-29T18:39:18.815660619Z","created_by":"bob","updated_at":"2026-01-29T18:42:48.488116080Z","closed_at":"2026-01-29T18:42:48.488085552Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-1y1","title":"Document label conventions for bead grooming","description":"Triage now includes bead grooming, which tells agents to add labels when appropriate. Need guidance on:\n\n- When to create vs reuse labels\n- Naming conventions (kebab-case? categories?)\n- Common label categories (e.g., type:bug, area:api, effort:small)\n- How to list existing labels (br label list)\n- Whether labels should be project-specific or cross-project\n\nThis was identified during eval-driven doc improvements — agents need to know what labels to use.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-29T23:04:19.555287633Z","created_by":"bob","updated_at":"2026-02-01T23:31:43.740813310Z","closed_at":"2026-02-01T23:31:43.740791019Z","close_reason":"Completed","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":23,"issue_id":"bd-1y1","author":"Bob","text":"Progress: Researched existing label usage (9 labels across categories: epic, eval, docs, cli, review, etc). Added comprehensive Label Conventions section to groom.md covering: when to label, categories, naming conventions, creating new labels, project-specific guidance, filtering, and examples. Location: packages/cli/docs/groom.md lines 44-89.","created_at":"2026-02-01T23:28:48Z"},{"id":24,"issue_id":"bd-1y1","author":"Bob","text":"Completed by crystal-anchor","created_at":"2026-02-01T23:31:41Z"}]}
{"id":"bd-20d","title":"Register auto-spawn hook during botbox init","description":"After botbus ships channel hooks (bd-2km in botbus), botbox init should register an auto-spawn hook so the project's dev agent starts automatically when messages arrive.\n\n## What to register\n\n```\nbus hooks add --channel <project> \\\n  --if-claim-available \"agent://<project>-dev\" \\\n  --cwd <abs-repo-path> \\\n  -- bash scripts/dev-loop.sh <project> <project>-dev\n```\n\n## Requirements\n\n- Only register if botbus is in the tools list\n- Only register if bus binary supports hooks (check bus hooks --help or version)\n- Use absolute repo path for --cwd\n- Skip gracefully if bus doesn't support hooks yet (don't fail init)\n- Idempotent: don't add duplicate hooks (check bus hooks list first)\n\n## Blocked by\n\nbotbus channel hooks feature (bd-2km in botbus project). File this bead but mark blocked until that ships.\n\n## Acceptance criteria\n\n- `botbox init` registers a hook for the project channel\n- `bus hooks list` shows the hook with correct channel, claim guard, cwd, and command\n- Running init twice doesn't create duplicate hooks\n- Init works fine if bus doesn't support hooks (graceful skip)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-02T16:03:35.066751488Z","created_by":"bob","updated_at":"2026-02-02T17:54:33.438626034Z","closed_at":"2026-02-02T17:54:33.438602920Z","close_reason":"Completed","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":47,"issue_id":"bd-20d","author":"Bob","text":"Blocked on botbus channel hooks feature (bd-2km in ~/src/botbus). Will unblock when bus hooks add ships.","created_at":"2026-02-02T16:03:52Z"},{"id":56,"issue_id":"bd-20d","author":"botbox-dev","text":"Completed: Added registerSpawnHook() to init.mjs. Registers 'bus hooks add --channel <project> --claim agent://<project>-dev --release-on-exit --cwd <abs-path> -- bash scripts/dev-loop.sh <project> <project>-dev'. Checks for hooks support (graceful skip if missing), deduplicates (checks bus hooks list before adding). 2 new tests: hook registration + idempotency. All 59 tests pass.","created_at":"2026-02-02T17:54:33Z"}]}
{"id":"bd-22i","title":"Warn when --init-beads is ignored due to tools list","description":"init --init-beads is silently skipped when beads is not in the tools list. Should warn the user: 'Skipping beads init: beads not in tools list'.","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-29T17:33:15.809769092Z","created_by":"bob","updated_at":"2026-01-29T17:37:25.439001077Z","closed_at":"2026-01-29T17:37:25.438977603Z","close_reason":"Completed","source_repo":".","compaction_level":0,"original_size":0,"labels":["review-finding","should-fix"]}
{"id":"bd-23n","title":"Document --dangerously-skip-permissions requirement for agent-loop.sh","description":"claude -p requires --dangerously-skip-permissions for autonomous file operations. This is currently hardcoded in agent-loop.sh but needs documentation. Add to eval-loop.md setup, AGENTS.md agent loop section, and consider making it configurable (CLAUDE_SKIP_PERMISSIONS env var).","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-30T14:23:47.728594911Z","created_by":"bob","updated_at":"2026-01-30T16:25:45.904990894Z","closed_at":"2026-01-30T16:25:45.904907669Z","close_reason":"--dangerously-skip-permissions added to agent-loop.sh, documented in script","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-25h","title":"Add timeout wrapper to claude calls in loop scripts","description":"Add timeout command to wrap claude calls in agent-loop.sh, dev-loop.sh, and reviewer-loop.sh to prevent hung API calls from blocking iterations indefinitely.\n\nCurrent issue: When Claude API returns 'No messages returned' or hangs, the process doesn't exit and blocks the entire loop.\n\nSolution: Wrap claude calls with timeout command:\n  timeout ${TIMEOUT} claude --model ...\n\nSuggested timeouts:\n- agent-loop.sh: 600s (10 min) - single task iteration\n- dev-loop.sh: 900s (15 min) - may dispatch workers, needs more time\n- reviewer-loop.sh: 600s (10 min) - single review iteration\n\nAfter timeout, the script should:\n1. Log the timeout event\n2. Optionally notify via bus send\n3. Continue to next iteration (let the outer loop handle retry logic)\n\nTesting: Verify timeout triggers correctly and loop continues.","status":"closed","priority":2,"issue_type":"task","owner":"botbox-dev","created_at":"2026-02-02T22:10:14.577385760Z","created_by":"botbox-dev","updated_at":"2026-02-02T22:11:59.590029939Z","closed_at":"2026-02-02T22:11:59.590006536Z","close_reason":"Completed: Added timeout wrapper to prevent hung Claude API calls","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":61,"issue_id":"bd-25h","author":"botbox-dev","text":"Implemented timeout wrapper for all three loop scripts\n\nChanges:\n- agent-loop.sh: CLAUDE_TIMEOUT=600s (10 min)\n- dev-loop.sh: CLAUDE_TIMEOUT=900s (15 min, needs more time for dispatching workers)\n- reviewer-loop.sh: CLAUDE_TIMEOUT=600s (10 min)\n\nWrapped claude commands with timeout:\n  if ! timeout \"$CLAUDE_TIMEOUT\" claude ...; then\n    exit_code=$?\n    if [[ $exit_code -eq 124 ]]; then\n      echo \"Claude timed out...\"\n      bus send ... -L tool-issue\n    else\n      echo \"Claude exited with code $exit_code\"\n    fi\n  fi\n\nAfter timeout (exit code 124) or error, the script:\n1. Logs the event to stdout (visible in botty tail)\n2. Sends bus notification to project channel with -L tool-issue\n3. Continues to next iteration (outer loop handles retry)\n\nAll tests pass (100/100). Syntax validated.","created_at":"2026-02-02T22:11:55Z"}]}
{"id":"bd-25u","title":"Include bead title in botbus announcements","description":"Agents currently post 'Working on bd-3cx' and 'Completed bd-3cx' on botbus. They should include the full bead title: 'Working on bd-3cx: Setup project structure and data models'. Update worker-loop.md announcement templates in the Start and Finish steps. Check other docs (start.md, finish.md, update.md) for the same pattern.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-01T22:31:46.928557704Z","created_by":"bob","updated_at":"2026-02-01T22:45:32.598258089Z","closed_at":"2026-02-01T22:45:32.598235106Z","close_reason":"Completed","source_repo":".","compaction_level":0,"original_size":0,"labels":["docs"],"dependencies":[{"issue_id":"bd-25u","depends_on_id":"bd-1c5","type":"blocks","created_at":"2026-02-01T22:37:50.943576629Z","created_by":"bob","metadata":"{}","thread_id":""},{"issue_id":"bd-25u","depends_on_id":"bd-3ni","type":"blocks","created_at":"2026-02-01T22:37:51.003955567Z","created_by":"bob","metadata":"{}","thread_id":""}],"comments":[{"id":20,"issue_id":"bd-25u","author":"Bob","text":"Updated Working/Completed announcement templates to include bead titles in worker-loop.md, start.md, and finish.md.","created_at":"2026-02-01T22:45:29Z"}]}
{"id":"bd-28m","title":"Add bus whoami check to agent identity instructions","description":"All docs that mention bus/botbus agent identity should recommend calling 'bus whoami' first to check if the agent already has an assigned identity before generating or adopting one. Update worker-loop.md Identity section and any other docs that cover agent naming (start.md, preflight.md, etc.).","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-01T22:31:46.991205333Z","created_by":"bob","updated_at":"2026-02-01T22:44:55.470963426Z","closed_at":"2026-02-01T22:44:55.470942166Z","close_reason":"Completed","source_repo":".","compaction_level":0,"original_size":0,"labels":["docs"],"dependencies":[{"issue_id":"bd-28m","depends_on_id":"bd-318","type":"blocks","created_at":"2026-02-01T22:37:50.881114868Z","created_by":"bob","metadata":"{}","thread_id":""},{"issue_id":"bd-28m","depends_on_id":"bd-qzg","type":"blocks","created_at":"2026-02-01T22:37:50.817767457Z","created_by":"bob","metadata":"{}","thread_id":""}],"comments":[{"id":17,"issue_id":"bd-28m","author":"Bob","text":"Added bus whoami guidance across identity sections in worker-loop/start/preflight and other identity-resolve steps.","created_at":"2026-02-01T22:44:52Z"}]}
{"id":"bd-29c","title":"Build the real botbox CLI (init, sync, doctor)","description":"The CLI scaffold is built with commander, inquirer, bun. Commands are stubbed with real logic. Needs end-to-end validation: run botbox init in a temp project, verify files created, run botbox sync, run botbox doctor. Fix any issues found.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-29T17:22:46.699530307Z","created_by":"bob","updated_at":"2026-01-29T19:36:56.263044270Z","closed_at":"2026-01-29T19:36:56.263018902Z","close_reason":"CLI is complete. init/sync/doctor all implemented with 50 passing tests and 8 e2e tests. Dog-fooded during development.","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-29l","title":"Register project on #projects channel during botbox init","description":"botbox init should register the project on the botbus #projects channel so other agents can discover it via report-issue.md.\n\n## What to send\n\n```\nbus send --agent <project>-dev projects \\\n  \"project:<name> repo:<abs-path> lead:<name>-dev tools:<tool-list>\" \\\n  -L project-registry\n```\n\nThe project name, repo path, and tools list are all available during init. The lead agent follows the convention `<project>-dev`.\n\n## Requirements\n\n- After botbox init completes, send a #projects registry message\n- Only send if botbus is in the tools list (don't send if the project doesn't use botbus)\n- Use absolute repo path (resolve relative paths)\n- Idempotent: running init twice shouldn't create duplicate registry entries (check if one exists first, or accept duplicates as harmless)\n- Skip gracefully if bus command isn't available (don't fail init)\n\n## Acceptance criteria\n\n- `botbox init --name myapp --type api --tools beads,botbus` sends a registry message\n- `bus history projects` shows the entry with correct format\n- `botbox init --name myapp --type api --tools beads` (no botbus) does NOT send\n- Init succeeds even if bus binary is missing","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-02T16:03:24.495407451Z","created_by":"bob","updated_at":"2026-02-02T16:06:36.043175277Z","closed_at":"2026-02-02T16:06:36.043149218Z","close_reason":"Completed","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":48,"issue_id":"bd-29l","author":"Bob","text":"Starting implementation","created_at":"2026-02-02T16:03:57Z"},{"id":50,"issue_id":"bd-29l","author":"Bob","text":"Done: added bus send to #projects after beads init in init.mjs. Sends registry entry with project name, abs path, lead agent, tools list. Skips gracefully if bus not installed. Tests added and passing.","created_at":"2026-02-02T16:06:36Z"}]}
{"id":"bd-2bv","title":"Add triage guidance for checking blocked bead status","description":"During grooming/triage, agents should check blocked beads to see if their blockers have been resolved (e.g., missing requirements were added, upstream tool fixed). If resolved, unblock and consider for work. Update triage.md and worker-loop.md with this guidance.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-30T14:23:47.315139001Z","created_by":"bob","updated_at":"2026-01-30T16:25:45.962545945Z","closed_at":"2026-01-30T16:25:45.962518293Z","close_reason":"Added blocked bead re-evaluation step to triage.md (step 4) and worker-loop.md","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-2bz","title":"Add botbus whoami guidance to agent-loop.sh and worker-loop.md","description":"Agent-loop.sh should run 'botbus whoami --agent $AGENT' at start to confirm identity. botbus v0.3.7+ generates a random name if BOTBUS_AGENT isn't set. Worker-loop.md preflight section should also recommend this. Currently agents get BOTBUS_AGENT from the script but whoami confirms it and handles the fallback case.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-30T16:21:49.331883347Z","created_by":"bob","updated_at":"2026-01-30T16:25:45.934682903Z","closed_at":"2026-01-30T16:25:45.934645933Z","close_reason":"Added botbus whoami --agent to agent-loop.sh and preflight.md, naming convention in worker-loop.md and preflight.md","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-2dt","title":"Draft mesh protocol spec","description":"Write initial mesh protocol draft with message schema, claims/leases, spawn lifecycle, and review loop.","status":"closed","priority":2,"issue_type":"docs","created_at":"2026-01-26T23:29:03.072497216Z","created_by":"bob","updated_at":"2026-01-26T23:29:52.038608285Z","closed_at":"2026-01-26T23:29:52.038538374Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-2dw","title":"Fix extra blank line in AGENTS.md when no reviewers","description":"renderAgentsMd produces a double blank line before the comment when reviewers is empty, due to template string interpolation of empty reviewerSection. Normalize the whitespace.","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-29T17:33:16.437183159Z","created_by":"bob","updated_at":"2026-01-29T17:37:25.449996035Z","closed_at":"2026-01-29T17:37:25.449977390Z","close_reason":"Completed","source_repo":".","compaction_level":0,"original_size":0,"labels":["review-finding","should-fix"],"dependencies":[{"issue_id":"bd-2dw","depends_on_id":"bd-3fm","type":"blocks","created_at":"2026-01-29T17:33:22.857666327Z","created_by":"bob","metadata":"{}","thread_id":""}]}
{"id":"bd-2dx","title":"R7: Planning eval — epic decomposition and sequencing","description":"Opus dev agent receives a large feature request, breaks it into beads with dependency graph, sequences work across iterations. Tests: (1) agent analyzes a complex feature (e.g., 'add user auth with OAuth + JWT + role-based access'), (2) creates an epic with subtasks, (3) sets dependencies between subtasks, (4) executes in correct order, (5) handles a subtask that reveals a design issue requiring replanning. Scoring: decomposition quality, dependency correctness, replanning ability.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-31T23:42:24.740165294Z","created_by":"bob","updated_at":"2026-02-01T22:28:02.490589203Z","closed_at":"2026-02-01T22:28:02.490522698Z","source_repo":".","compaction_level":0,"original_size":0,"labels":["eval"],"dependencies":[{"issue_id":"bd-2dx","depends_on_id":"bd-ppt","type":"blocks","created_at":"2026-01-31T23:42:40.653946553Z","created_by":"bob","metadata":"{}","thread_id":""}],"comments":[{"id":10,"issue_id":"bd-2dx","author":"Bob","text":"R8 informs R7 design: The bd-138 breakdown (5 subtasks with dependency ordering) is itself a testable planning behavior. R7 should score: (1) does agent create resumable subtasks (not just a flat list), (2) are dependencies wired correctly (sibling ordering, not just parent-child), (3) does each subtask have clear acceptance criteria. The 'one bead = one resumable unit' principle from groom.md is the standard.","created_at":"2026-02-01T19:43:50Z"},{"id":12,"issue_id":"bd-2dx","author":"Bob","text":"R7-1 complete: Opus 76/95 (80%) PASS. Strong diamond DAG (7 subtasks, 3 parallel). Completed 3/7 subtasks before context limit, all code compiles, 8 tests pass. Key finding: worker-loop.md lacked decomposition guidance — agent created good structure but skipped parent grooming, flat priorities, and implicit SQLite decision. Updated worker-loop.md triage step with detailed decomposition protocol. Eval is done — remaining gaps (multi-agent handoff) belong to the full autonomous workflow, not R7.","created_at":"2026-02-01T22:27:58Z"}]}
{"id":"bd-2f9","title":"Fix has_work() wasted iteration from self-messages","description":"After agent sends 'Completed bd-xxx' on the project channel, has_work() sees unread messages and spawns a claude session that finds no work. Upstream fix requested in #botbus (self-messages shouldn't count as unread). Fallback: only check br ready in has_work(), drop inbox check. Or mark own messages as read after sending.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-30T14:23:47.198651008Z","created_by":"bob","updated_at":"2026-01-30T16:05:43.138958537Z","closed_at":"2026-01-30T16:05:43.138930836Z","close_reason":"Fixed upstream in botbus v0.3.8 — inbox now filters own messages","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-2fo","title":"Write and run agent-loop.sh eval","description":"Create an eval doc for testing agent-loop.sh end-to-end. The eval should:\n\n1. Set up a fresh botbox project with 2-3 beads of varying quality\n2. Run agent-loop.sh (or simulate its behavior) with Sonnet\n3. Verify the shell loop works: one bead per iteration, has_work() gate, clean exit\n4. Score each iteration using the Level 2 rubric\n5. Verify shell-level concerns: cleanup trap, agent lease, shutdown message\n\nKey difference from Level 2 evals: the shell script controls iteration, not the agent.\nThe agent should complete exactly one task per invocation.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-29T23:55:21.777899728Z","created_by":"bob","updated_at":"2026-01-30T16:21:54.451536600Z","closed_at":"2026-01-30T16:21:54.451513827Z","close_reason":"Eval written (eval-loop.md) and executed (2 runs: run 1 found has_work() bugs + sandbox issue, run 2 scored 211/218 97%)","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":2,"issue_id":"bd-2fo","author":"Bob","text":"Context for next session:\n- eval-loop.md has the full eval plan (218 pts total)\n- agent-loop.sh is updated with all eval learnings (random workspaces, grooming, exit-after-finish)\n- maw v0.8.0 fixed the merge issue (bd-l3w closed)\n- maw output now includes 'IMPORTANT: All files must be under this path'\n- Use Option B (simulate per-iteration) to avoid running the full shell script\n- Seed 2 beads: 1 well-specified, 1 poorly specified\n- Key test: does the agent complete exactly 1 bead then stop?","created_at":"2026-01-30T00:02:53Z"}]}
{"id":"bd-2fq","title":"Add review-loop.md guidance for workspace code visibility during re-review","description":"The review-loop.md doc should include explicit guidance for reviewers during re-review: read code from the workspace path, not from the project root. The project root has the pre-fix code until merge.\n\nAdd a note like:\n  IMPORTANT: During re-review, the author's fixes are in their workspace, not the main branch.\n  Check the botbus review-response message for the workspace path, or use maw ws list to find it.\n  Read source files from .workspaces/<ws-name>/ to see the current code.\n\nDiscovered in R4-1: reviewer read main branch src/main.rs (unfixed) instead of workspace copy (fixed), resulting in a false 'NOT FIXED' re-block.\n\nAcceptance criteria:\n- review-loop.md includes workspace visibility guidance for re-review step\n- Guidance is clear enough that a reviewer agent follows it without explicit prompt help\n\nTesting: bun test (doc hash changes)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-31T19:59:49.313763836Z","created_by":"bob","updated_at":"2026-01-31T20:14:11.607477654Z","closed_at":"2026-01-31T20:14:11.607453118Z","close_reason":"Added Re-review section to review-loop.md with workspace visibility guidance","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-2g4","title":"Add language selection to botbox init with .gitignore generation","description":"Add a language/framework selection step to botbox init (e.g., rust, python, node, go). Use a CLI tool (like gitignore.io or similar) to generate an appropriate .gitignore for the selected language. Should be optional — skip if .gitignore already exists. Add --language flag for non-interactive use.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-30T16:53:44.402288614Z","created_by":"bob","updated_at":"2026-02-01T23:44:04.048605557Z","closed_at":"2026-02-01T23:44:04.048581792Z","close_reason":"Completed","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":26,"issue_id":"bd-2g4","author":"Bob","text":"Implementation complete: Added language selection to botbox init with .gitignore generation using gitignore.io. Tested non-interactive mode and existing .gitignore skip logic.","created_at":"2026-02-01T23:38:17Z"},{"id":27,"issue_id":"bd-2g4","author":"Bob","text":"Review requested: cr-rgy9, workspace: silent-tower (/home/bob/src/botbox/.workspaces/silent-tower)","created_at":"2026-02-01T23:38:48Z"},{"id":28,"issue_id":"bd-2g4","author":"Bob","text":"Waiting for review feedback on cr-rgy9. Created follow-up bead bd-1jk to address documentation errors identified in review cr-xvwo.","created_at":"2026-02-01T23:40:41Z"},{"id":29,"issue_id":"bd-2g4","author":"Bob","text":"Completed by crystal-anchor","created_at":"2026-02-01T23:44:01Z"}]}
{"id":"bd-2gl","title":"Replace process.exit() in commands with thrown errors","description":"Commands call process.exit() directly, which kills testability and prevents composition. Refactor: commands throw errors or return exit codes, entry point (index.mjs) catches and calls process.exit(). This also fixes doctor calling process.exit(0) on success and unblocks testing sync --check and sync with missing .agents/.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-29T17:33:14.716639412Z","created_by":"bob","updated_at":"2026-01-29T17:36:31.803459446Z","closed_at":"2026-01-29T17:36:31.803435641Z","close_reason":"Completed","source_repo":".","compaction_level":0,"original_size":0,"labels":["review-finding","should-fix"]}
{"id":"bd-2n7","title":"copy beads grooming guidelines from triage.md to groom.md","description":"This is because I occasionally ask agents just to groom beads.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-31T20:56:25.781130366Z","created_by":"bob","updated_at":"2026-01-31T20:57:00.357261766Z","closed_at":"2026-01-31T20:57:00.315988068Z","close_reason":"Created groom.md with beads grooming guidelines extracted from triage.md. Includes: title/description/priority/labels/acceptance criteria/testing strategy validation. Handles bead breakdown and announces grooming completions.","source_repo":".","compaction_level":0,"original_size":0,"labels":["skill"],"comments":[{"id":4,"issue_id":"bd-2n7","author":"Bob","text":"Closed: groom.md created","created_at":"2026-01-31T20:57:00Z"}]}
{"id":"bd-2od","title":"Rename botbus to bus in all docs","description":"The main binary for botbus has been renamed to bus. Update all workflow docs, CLAUDE.md, and any other references. Search for 'botbus' across the repo and replace with 'bus' where it refers to the CLI command. Keep 'botbus' where it refers to the project/system name (e.g., 'the botbus channel').","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-01T22:31:46.961251737Z","created_by":"bob","updated_at":"2026-02-01T22:45:45.715673500Z","closed_at":"2026-02-01T22:45:45.715656258Z","close_reason":"Completed","source_repo":".","compaction_level":0,"original_size":0,"labels":["docs"],"dependencies":[{"issue_id":"bd-2od","depends_on_id":"bd-35u","type":"blocks","created_at":"2026-02-01T22:37:50.689387577Z","created_by":"bob","metadata":"{}","thread_id":""},{"issue_id":"bd-2od","depends_on_id":"bd-ztw","type":"blocks","created_at":"2026-02-01T22:37:50.752069751Z","created_by":"bob","metadata":"{}","thread_id":""}],"comments":[{"id":21,"issue_id":"bd-2od","author":"Bob","text":"Replaced botbus CLI references with bus across workflow docs and core project docs (README, eval-review/loop, dev-agent-architecture, AGENTS). Kept botbus for system/channel mentions.","created_at":"2026-02-01T22:45:42Z"}]}
{"id":"bd-2r0","title":"R4-2: Re-run integration eval with crit v0.9.1","description":"Re-run R4 integration eval to verify crit v0.9.1 fixes the vote index bug (bd-1s1). Phase 4 should now succeed without manual index rebuild or prompt workaround for workspace path.\n\nSteps:\n1. Update crit to v0.9.1+ in the eval environment\n2. Run scratchpad/r4-setup.sh\n3. Run all 5 phases\n4. Score and compare to R4-1 (89/95)\n5. Write eval report, update eval-review.md + README\n\nKey question: Does Phase 4 re-review work without the workspace path hint in the prompt? Test both with and without the hint to see if the crit diff fix (bd-2do, if shipped) makes the workspace path unnecessary.\n\nExpected: 95/95 if vote bug is fixed. If workspace visibility still needs the prompt hint, 93-95/95.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-31T22:11:09.523437866Z","created_by":"bob","updated_at":"2026-01-31T22:39:15.482455124Z","closed_at":"2026-01-31T22:39:15.482422463Z","close_reason":"R4-2 complete: 95/95 (100%). crit v0.9.1 vote override fix confirmed.","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-2rb","title":"R6: Parallel dispatch eval","description":"Dev agent receives 3+ independent beads, spawns Haiku workers in parallel, tracks completions, handles failures (worker gets stuck or produces bad code). Tests: (1) dev agent triages multiple beads, (2) creates workspaces and dispatches workers via claude -p, (3) monitors progress via botbus, (4) handles a stuck worker (timeout → reassign), (5) reviews and merges completed work. Scoring: dispatch correctness, failure handling, merge sequencing.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-31T23:42:18.648617336Z","created_by":"bob","updated_at":"2026-02-02T02:13:41.051923780Z","closed_at":"2026-02-02T02:13:41.051897440Z","close_reason":"R6-1: Opus 69/70 (99%). Parallel dispatch validated.","source_repo":".","compaction_level":0,"original_size":0,"labels":["eval"],"comments":[{"id":43,"issue_id":"bd-2rb","author":"Bob","text":"R6-1 complete: Opus 69/70 (99%). Perfect parallel dispatch — 3 Haiku workers launched in 2s, all completed in 85s wall-clock. Dev agent pre-wrote code in worker prompts. All beads closed, workspaces destroyed, cargo check passes. Only deduction: jj merge conflict markers (cosmetic). See eval-results/2026-02-02-r6-run1.md.","created_at":"2026-02-02T02:13:25Z"}]}
{"id":"bd-2s1","title":"R5: Multi-project coordination eval","description":"Dev agents from different projects file cross-project issues (report-issue.md), review each other's APIs, and coordinate via botbus #projects registry. Tests: (1) dev agent discovers a dependency issue in another project, (2) files an issue via report-issue.md, (3) other project's agent picks it up, (4) fix flows back. Scoring: issue filed correctly, cross-project botbus routing, fix integrated.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-31T23:42:12.611527372Z","created_by":"bob","updated_at":"2026-02-02T14:13:09.725740708Z","closed_at":"2026-02-02T14:13:09.725709680Z","close_reason":"Completed","source_repo":".","compaction_level":0,"original_size":0,"labels":["eval"],"comments":[{"id":44,"issue_id":"bd-2s1","author":"Bob","text":"R5-1 complete: Opus 70/70 (100%). Perfect cross-project coordination — agent queried #projects registry, found r5-utils, filed detailed bug report (bd-31f) for validate_name() off-by-one, announced with -L feedback and @r5-utils-dev. Implemented correct validation in r5-app. Used BOTBUS_DATA_DIR isolation to avoid polluting real registry.","created_at":"2026-02-02T14:12:49Z"}]}
{"id":"bd-2tg","title":"Draft botbox website","description":"Create a minimal brutalist botbox landing page for agents, covering tools and workflow.","status":"closed","priority":2,"issue_type":"docs","created_at":"2026-01-27T14:14:39.448840834Z","created_by":"bob","updated_at":"2026-01-27T14:15:23.058956182Z","closed_at":"2026-01-27T14:15:23.058873196Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-2ue","title":"Add tool-issue botbus reporting to workflow docs","description":"When agents encounter unexpected tool behavior (e.g., maw ws merge --destroy not destroying, br update failing silently), they should post a botbus message with -L tool-issue for observability. Add guidance to worker-loop.md stuck check section and finish.md. Example: botbus send --agent $AGENT $PROJECT 'Tool issue: maw ws merge --destroy did not remove workspace' -L tool-issue","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-30T14:23:47.593348743Z","created_by":"bob","updated_at":"2026-01-30T16:25:46.022592312Z","closed_at":"2026-01-30T16:25:46.022559470Z","close_reason":"Added tool-issue reporting to worker-loop.md stuck check and finish.md workspace destroy","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-2ul","title":"Improve review-loop.md: add cross-file consistency and boundary checks","description":"Add two new review steps to review-loop.md: (1) cross-file consistency comparison step between individual file review and commenting, (2) boundary/arithmetic check on user-supplied values. These address gaps found in R8v2 where both models missed TOCTOU (no cross-file comparison) and pagination underflow (no boundary checking). Also update r8-run.sh to reference the doc instead of embedding the workflow inline.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-01T19:37:38.136547583Z","created_by":"bob","updated_at":"2026-02-01T19:38:57.573034883Z","closed_at":"2026-02-01T19:38:57.572960023Z","source_repo":".","compaction_level":0,"original_size":0,"labels":["eval"],"comments":[{"id":8,"issue_id":"bd-2ul","author":"Bob","text":"Done. review-loop.md updated with cross-file consistency (3f) and boundary checks (3g). r8-run.sh now references the doc instead of embedding. r8-setup.sh copies local docs. Tests pass (50/50). Committed as 4f5662a1.","created_at":"2026-02-01T19:38:57Z"}]}
{"id":"bd-2ya","title":"Fix sync printing null for missing version marker","description":"When .version file is missing, readVersionMarker returns null. sync.mjs prints 'Synced: null → abc123'. Should print 'Synced: (none) → abc123' or similar.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-29T17:33:15.114715661Z","created_by":"bob","updated_at":"2026-01-29T17:36:31.813981708Z","closed_at":"2026-01-29T17:36:31.813957092Z","close_reason":"Completed","source_repo":".","compaction_level":0,"original_size":0,"labels":["review-finding","should-fix"],"dependencies":[{"issue_id":"bd-2ya","depends_on_id":"bd-2gl","type":"blocks","created_at":"2026-01-29T17:33:22.837507124Z","created_by":"bob","metadata":"{}","thread_id":""}]}
{"id":"bd-2ym","title":"Write tests for @botbox/cli","description":"Write bun test suite covering: lib/docs.mjs (listWorkflowDocs, copyWorkflowDocs, currentVersion, version markers), lib/templates.mjs (renderAgentsMd, updateManagedSection with and without existing markers), commands/init.mjs (non-interactive mode, file creation, symlink), commands/sync.mjs (up-to-date check, stale detection, update), commands/doctor.mjs (tool checks, project structure checks). Use bun:test framework with temp directories.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-29T17:22:46.527815809Z","created_by":"bob","updated_at":"2026-01-29T17:25:07.020276186Z","closed_at":"2026-01-29T17:25:07.020248515Z","close_reason":"Completed","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-2zx","title":"Improve workflow docs based on eval insights","description":"Based on Level 2 eval results (Opus: 100%, Sonnet: 88%), improve workflow docs to close the 11-point gap:\n\n1. Emphasize complete workflow sequence (triage → start → update → finish)\n2. Clarify optional vs mandatory steps in docs\n3. Add explicit workspace cleanup to finish.md (merge + destroy)\n4. Clarify progress update timing in update.md (at least once during work)\n5. Reference worker-loop.md more prominently in AGENTS.md managed section\n6. Fix claim format from \"src/**\" to \"file://<project>/<file-glob>\"\n\nGap analysis:\n- No triage workflow (-2)\n- No progress update (-2)\n- Workspace not destroyed (-2)\n- Error handling gap (-5)\n\nAll gaps are documentation clarity issues, not capability issues.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-29T21:22:17.026061387Z","created_by":"bob","updated_at":"2026-01-29T21:23:45.635892504Z","closed_at":"2026-01-29T21:23:45.635863320Z","close_reason":"Completed","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":1,"issue_id":"bd-2zx","author":"Bob","text":"Completed workflow doc improvements:\n\n1. Fixed claim format: \"path/**\" → \"file://$BOTBOX_PROJECT/path/**\" (start.md + templates.mjs)\n2. Emphasized progress comments: \"at least one during work\" (worker-loop.md)\n3. Clarified update.md description: \"status updates\" → \"change bead status\" (templates.mjs)\n4. Emphasized workspace cleanup: made --destroy flag importance clear (finish.md)\n5. Added pointer to worker-loop.md as canonical workflow in managed section\n\nAll tests pass (50/50). Version hash: 14e15a9821fe","created_at":"2026-01-29T21:23:42Z"}]}
{"id":"bd-30v","title":"E2E: interactive edge cases via botty","description":"Test 7 from testing.md — arrow keys, deselect all, send-bytes for special keys","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-29T18:39:18.889592741Z","created_by":"bob","updated_at":"2026-01-29T18:45:49.631799510Z","closed_at":"2026-01-29T18:45:49.631780985Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-30v","depends_on_id":"bd-32v","type":"blocks","created_at":"2026-01-29T18:39:22.431763553Z","created_by":"bob","metadata":"{}","thread_id":""}]}
{"id":"bd-318","title":"Check other naming docs for whoami guidance","description":"Scan other workflow docs for agent naming/identity and add 'bus whoami' guidance where missing.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-01T22:34:31.696841109Z","created_by":"bob","updated_at":"2026-02-01T22:44:44.620734762Z","closed_at":"2026-02-01T22:44:44.620713462Z","close_reason":"Completed","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":16,"issue_id":"bd-318","author":"Bob","text":"Added bus whoami confirmation notes to remaining identity-resolve steps (triage, update, finish, merge-check, review-request, review-loop, review-response).","created_at":"2026-02-01T22:44:41Z"}]}
{"id":"bd-32v","title":"E2E: interactive init via botty","description":"Test 2 from testing.md — spawn botbox init inside botty, drive prompts with send/wait/snapshot","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-29T18:39:18.836055714Z","created_by":"bob","updated_at":"2026-01-29T18:45:49.627517082Z","closed_at":"2026-01-29T18:45:49.627489710Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-32v","depends_on_id":"bd-1ws","type":"blocks","created_at":"2026-01-29T18:39:22.411314958Z","created_by":"bob","metadata":"{}","thread_id":""}]}
{"id":"bd-35u","title":"Update workflow docs to use bus CLI","description":"Replace botbus CLI command references with bus in packages/cli/docs, preserving botbus when referring to the system or channel.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-01T22:34:22.516757868Z","created_by":"bob","updated_at":"2026-02-01T22:37:53.744255429Z","closed_at":"2026-02-01T22:37:53.744238637Z","close_reason":"Completed","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":13,"issue_id":"bd-35u","author":"Bob","text":"Updated workflow docs in packages/cli/docs to use bus commands; adjusted announcement templates and whoami guidance where applicable.","created_at":"2026-02-01T22:37:15Z"}]}
{"id":"bd-36m","title":"R8v2: run Opus eval, score, write report","description":"Fresh r8-setup.sh, run r8-run.sh with CLAUDE_MODEL=opus. Score against v2 rubric (65pts). Write eval-results/2026-02-01-review-r8-run2-opus.md. Key: cross-file reasoning category (did reviewer compare download.rs vs delete.rs?).","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-01T19:08:10.496823470Z","created_by":"bob","updated_at":"2026-02-01T19:18:50.297840219Z","closed_at":"2026-02-01T19:18:50.297765449Z","source_repo":".","compaction_level":0,"original_size":0,"labels":["eval"],"dependencies":[{"issue_id":"bd-36m","depends_on_id":"bd-138","type":"blocks","created_at":"2026-02-01T19:08:26.437578467Z","created_by":"bob","metadata":"{}","thread_id":""},{"issue_id":"bd-36m","depends_on_id":"bd-gei","type":"blocks","created_at":"2026-02-01T19:08:30.663601532Z","created_by":"bob","metadata":"{}","thread_id":""}],"comments":[{"id":6,"issue_id":"bd-36m","author":"Bob","text":"Opus scored 49/65 (75%). Found Bug 1 (race) and Bug 2 (TOCTOU) perfectly (24/24). Missed Bug 3 (pagination underflow, 0/6). No cross-file reasoning for TOCTOU (0/5) — found via internal delete.rs analysis, not download.rs comparison. FP resistance perfect under v2 rules (5/5). Report written to eval-results/2026-02-01-review-r8-run2-opus.md.","created_at":"2026-02-01T19:18:45Z"}]}
{"id":"bd-397","title":"Add files field to package.json","description":"No files field in package.json. Add files: [src/, docs/] to ensure workflow docs ship in the npm tarball.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-29T17:33:16.239707729Z","created_by":"bob","updated_at":"2026-01-29T17:37:25.449464609Z","closed_at":"2026-01-29T17:37:25.449436336Z","close_reason":"Completed","source_repo":".","compaction_level":0,"original_size":0,"labels":["review-finding","should-fix"]}
{"id":"bd-3e7","title":"Add agent naming convention to workflow docs","description":"Convention: agents should adopt <project>-dev as their name (e.g., botbox-dev, maw-dev) unless spawned by agent-loop.sh (which generates random names like storm-raven). Update worker-loop.md identity section and preflight.md. The agent-loop.sh already handles this with botbus generate-name.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-30T16:23:36.583541354Z","created_by":"bob","updated_at":"2026-01-30T16:25:46.079834977Z","closed_at":"2026-01-30T16:25:46.079808477Z","close_reason":"Added naming convention to worker-loop.md identity section and preflight.md step 1","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-3fi","title":"Add botbox-triage skill to handle incoming work requests","description":"The triage skill (draft/triage.md) needs to handle cross-project work requests via botbus. Define the convention: how an agent in project X sends a task-request to project Y's channel, and how the triage loop picks it up and creates a bead.","status":"closed","priority":3,"issue_type":"feature","created_at":"2026-01-29T17:22:47.223273035Z","created_by":"bob","updated_at":"2026-01-29T19:37:00.333127272Z","closed_at":"2026-01-29T19:37:00.333099089Z","close_reason":"Obsolete. Pivoted away from skills to workflow docs. Triage is now documented in triage.md and report-issue.md handles cross-project feedback.","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-3fm","title":"Prevent init from silently overwriting AGENTS.md","description":"botbox init unconditionally overwrites AGENTS.md if it exists. Should detect existing file and either warn+skip or require --force flag. Same pattern as the CLAUDE.md symlink check.","status":"closed","priority":0,"issue_type":"bug","created_at":"2026-01-29T17:33:14.491893090Z","created_by":"bob","updated_at":"2026-01-29T17:35:09.073900602Z","closed_at":"2026-01-29T17:35:09.073876136Z","close_reason":"Completed","source_repo":".","compaction_level":0,"original_size":0,"labels":["must-fix","review-finding"]}
{"id":"bd-3gl","title":"Add cross-project feedback workflow and #projects registry","description":"Enable agents to discover projects, file bugs in other repos, and notify project leads.\n\nComponents:\n1. New doc: report-issue.md (or cross-project-feedback.md)\n   - Query #projects registry to find tool owner\n   - Navigate to project repo\n   - Create beads with br create\n   - Post to project channel with -L feedback tagging @<lead-agent>\n\n2. Update triage.md\n   - Add step for handling -L feedback messages from other agents\n   - Review mentioned beads, respond on botbus\n\n3. Populate #projects registry\n   - Format: 'project:<name> repo:<path> lead:<agent> tools:<tool1>,<tool2>'\n   - Labels: -L project-registry\n   - Initial projects: botty, botbus, beads_rust, botcrit, maw, botbox\n\n4. Update AGENTS.md managed section template\n   - Mention #projects registry pattern\n   - Link to report-issue.md\n\nThis enables the full loop:\n- Agent uses tool, encounters issue\n- Agent files beads in tool's repo\n- Agent notifies tool's lead agent\n- Lead agent triages and responds","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-29T19:20:08.085772239Z","created_by":"bob","updated_at":"2026-01-29T19:22:14.970190555Z","closed_at":"2026-01-29T19:22:14.970166410Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-3jw","title":"crit reviews create: add --workspace flag","description":"Add --workspace <path> flag to crit reviews create that stores the workspace absolute path in review metadata (the existing workspace: null field). Reviewers need this to know where to read source files — the diff shows relative paths but the actual files live in .workspaces/$WS/, not the project root. This was the #1 friction point in multi-agent run 1: the reviewer read from project root 4+ times before finding the workspace path buried in bead comments.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-02-02T00:44:31.434581943Z","created_by":"bob","updated_at":"2026-02-02T00:45:20.346959412Z","closed_at":"2026-02-02T00:45:20.346926961Z","close_reason":"Filed in botcrit as bd-1ck","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-3k9","title":"E2E: doctor healthy vs broken","description":"Test 6 from testing.md — init then break things, verify doctor catches each issue","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-29T18:39:18.876885248Z","created_by":"bob","updated_at":"2026-01-29T18:42:48.499296840Z","closed_at":"2026-01-29T18:42:48.499283646Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0,"dependencies":[{"issue_id":"bd-3k9","depends_on_id":"bd-1ws","type":"blocks","created_at":"2026-01-29T18:39:22.445224739Z","created_by":"bob","metadata":"{}","thread_id":""}]}
{"id":"bd-3ks","title":"Guard updateManagedSection against corrupt markers","description":"updateManagedSection in templates.mjs can corrupt files when markers are out of order (endIdx < startIdx) or only one marker exists. Add guards: if endIdx < startIdx, treat as missing. If only one marker present, treat as missing. Add tests for these edge cases.","status":"closed","priority":0,"issue_type":"bug","created_at":"2026-01-29T17:33:13.837922358Z","created_by":"bob","updated_at":"2026-01-29T17:34:08.864216426Z","closed_at":"2026-01-29T17:34:08.864187783Z","close_reason":"Completed","source_repo":".","compaction_level":0,"original_size":0,"labels":["must-fix","review-finding"]}
{"id":"bd-3ls","title":"Add project-type-conditional design docs to botbox init","description":"When botbox init asks for project type (cli, tui, api, library), copy relevant design guideline docs to .agents/botbox/design/. Source from packages/cli/docs/design/. Examples: CLI design conventions for cli/tui projects, API design conventions for api projects. Uses same bundled doc mechanism as workflow docs, managed by botbox sync. Source material in ~/src/ai-docs.","status":"open","priority":4,"issue_type":"task","created_at":"2026-01-30T18:11:15.002573428Z","created_by":"bob","updated_at":"2026-01-30T18:11:15.002573428Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-3m6","title":"crit reviews list: add --status filter","description":"Add --status <open|merged|abandoned> filter to crit reviews list. Currently reviewers must parse JSON client-side to find open reviews. Server-side filtering simplifies the reviewer loop and avoids processing merged/abandoned reviews.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-02-02T00:44:33.289657752Z","created_by":"bob","updated_at":"2026-02-02T00:45:20.394667588Z","closed_at":"2026-02-02T00:45:20.394643343Z","close_reason":"Filed in botcrit as bd-26k","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-3ni","title":"Add bead title to other announcement docs","description":"Update start.md, finish.md, and update.md announcement templates to include bead titles where they mention Working/Completed messages.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-01T22:34:39.421858727Z","created_by":"bob","updated_at":"2026-02-01T22:45:20.417399074Z","closed_at":"2026-02-01T22:45:20.417380859Z","close_reason":"Completed","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":19,"issue_id":"bd-3ni","author":"Bob","text":"Updated start.md and finish.md announcement templates to include bead titles; update.md uses status format so no matching Working/Completed template.","created_at":"2026-02-01T22:45:15Z"}]}
{"id":"bd-3om","title":"Bundle Claude Code hooks and write project-level .claude/settings.json during botbox init","description":"Currently the botbus-workflow hooks (init-agent.sh, check-bus-inbox.sh) live in ~/.claude/hooks/ and are hand-managed globally. They should be bundled in packages/cli/hooks/, copied during botbox init, and wired into a project-level .claude/settings.json so they only activate in botbox projects.\n\nHooks to bundle:\n- init-agent.sh (SessionStart) — calls bus whoami to get agent identity\n- check-bus-inbox.sh (PostToolUse) — polls bus inbox and injects reminder for unread messages\n\nAcceptance criteria:\n- packages/cli/hooks/ contains bundled hook scripts\n- botbox init writes .claude/settings.json with hooks config pointing to copied scripts\n- botbox sync updates hook scripts (same version marker pattern as docs/scripts)\n- botbox doctor checks hook script staleness\n- Hooks only run in botbox-initialized projects (not globally)","status":"open","priority":2,"issue_type":"task","owner":"botbox-dev","created_at":"2026-02-02T20:02:30.371414263Z","created_by":"botbox-dev","updated_at":"2026-02-02T20:02:30.371414263Z","source_repo":".","compaction_level":0,"original_size":0,"labels":["cli"]}
{"id":"bd-3ov","title":"Read version from package.json instead of hardcoding","description":"Version 0.0.1 is duplicated in package.json and index.mjs. Read version from package.json dynamically so they cannot drift.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-29T17:33:14.911378604Z","created_by":"bob","updated_at":"2026-01-29T17:36:31.813475289Z","closed_at":"2026-01-29T17:36:31.813460010Z","close_reason":"Completed","source_repo":".","compaction_level":0,"original_size":0,"labels":["review-finding","should-fix"]}
{"id":"bd-3s6","title":"Publish placeholder packages to npm","description":"Publish @botbox/cli and botbox to npm as 0.0.1 placeholders to reserve the names. Use just publish.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-29T17:22:46.887132725Z","created_by":"bob","updated_at":"2026-01-29T19:39:20.177575437Z","closed_at":"2026-01-29T19:39:20.177548256Z","close_reason":"done by bob","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-3sy","title":"R9: Recovery eval — mid-run failure simulation","description":"Simulate failures during agent execution and test recovery: (1) worker crashes mid-task (workspace exists but work is incomplete), (2) reviewer times out (review requested but never completed), (3) botbus message lost (claim exists but no announcement), (4) crit index corruption (vote recorded but not queryable). Tests whether the dev agent recovers gracefully on next iteration — detects stale state, retries or reassigns, doesn't duplicate work. Scoring: detection of stale state, correct recovery action, no data loss.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-31T23:42:36.800127904Z","created_by":"bob","updated_at":"2026-02-02T14:15:12.070383240Z","closed_at":"2026-02-02T14:15:12.070355027Z","close_reason":"Completed","source_repo":".","compaction_level":0,"original_size":0,"labels":["eval"],"comments":[{"id":11,"issue_id":"bd-3sy","author":"Bob","text":"R8 informs R9 design: The CLAUDE.md bead tracking requirements (progress comments with 'what was done, what remains') are exactly what R9 needs to validate. Test scenario: agent completes 2 of 5 subtasks, session crashes, fresh session reads bead comments and resumes at subtask 3 without redoing work or losing context. Score: (1) reads bead comments before acting, (2) correctly identifies completed vs remaining work, (3) doesn't duplicate completed subtasks.","created_at":"2026-02-01T19:43:56Z"},{"id":45,"issue_id":"bd-3sy","author":"Bob","text":"R9-1 complete: Opus 69/70 (99%). Perfect crash recovery — detected claims, read bead comments, completed S3 in existing workspace without redoing S1/S2, finished S4+S5. All code compiles, all beads closed.","created_at":"2026-02-02T14:15:12Z"}]}
{"id":"bd-3u9","title":"Add --actor to all br commands in workflow docs and scripts","description":"## Problem\n\nAll mutating br commands (create, update, close, comments add, dep add) support --actor <name> for the audit trail, but our workflow docs and scripts don't use it. This means all bead mutations are attributed to the OS username (bob) instead of the agent identity. Same issue with --owner on br create.\n\n## What to change\n\n### Workflow docs (packages/cli/docs/*.md)\n\nEvery br command in the docs should include --actor \\$AGENT:\n- br create --actor \\$AGENT --owner \\$AGENT ...\n- br update --actor \\$AGENT <id> ...\n- br close --actor \\$AGENT <id> ...\n- br comments add --actor \\$AGENT <id> \"...\"\n- br dep add --actor \\$AGENT ...\n\n### Scripts (scripts/*.sh)\n\nThe inner prompts in agent-loop.sh, dev-loop.sh, and reviewer-loop.sh reference br commands. These should also include --actor \\$AGENT (where \\$AGENT is the agent's botbus identity).\n\n### CLAUDE.md\n\nThe Beads section references br commands — update those too.\n\n## Notes\n\n- --actor is available on all mutating br commands (create, update, close, comments add, dep add, dep remove)\n- --owner on br create sets the owner field (distinct from actor which is the audit trail)\n- For br create, use both: br create --actor \\$AGENT --owner \\$AGENT ...\n- br comments add also has --author which overrides the comment author (distinct from --actor)\n- For br comments add, use both: br comments add --actor \\$AGENT --author \\$AGENT <id> \"...\"\n- Read-only commands (br show, br ready, br sync) don't need --actor\n\n## Acceptance criteria\n\n- All br create commands in docs include --actor \\$AGENT --owner \\$AGENT\n- All br update/close commands include --actor \\$AGENT\n- All br comments add commands include --actor \\$AGENT --author \\$AGENT\n- All br dep add/remove commands include --actor \\$AGENT\n- Scripts' inner prompts updated\n- CLAUDE.md bead section updated","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-02T16:20:53.464733551Z","created_by":"bob","updated_at":"2026-02-02T16:28:10.050766200Z","closed_at":"2026-02-02T16:28:10.050738017Z","close_reason":"Completed","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":52,"issue_id":"bd-3u9","author":"Bob","text":"Starting: updating all workflow docs, scripts, and CLAUDE.md","created_at":"2026-02-02T16:20:57Z"},{"id":53,"issue_id":"bd-3u9","author":"botbox-dev","text":"Completed: Added --actor $AGENT to all mutating br commands across 11 files (7 workflow docs, 2 scripts, CLAUDE.md, start.md). Also added --owner $AGENT on br create, --author $AGENT on br comments add. Updated IMPORTANT instruction in agent-loop.sh and dev-loop.sh prompts. Fixed dev-loop.sh worker prompt template (was incorrectly saying --agent for br commands, now correctly says --actor). All 54 tests pass.","created_at":"2026-02-02T16:28:07Z"}]}
{"id":"bd-3uf","title":"Update hook registration for --claim-owner flag","description":"Update botbox to use botbus v0.11.0's --claim-owner flag. Changes needed:\n\n1. init.mjs registerSpawnHook(): add --claim-owner ${agent} to the bus hooks add command\n2. dev-loop.sh / agent-loop.sh / reviewer-loop.sh: remove the startup bus claims stake for agent:// claim (hook already handles it), replace with bus claims refresh\n3. check-expiring-claims.sh hook will prompt agents to refresh — verify this works end-to-end\n4. Update workflow docs if claim lifecycle instructions change\n\nRequires: botbus v0.11.0+","status":"closed","priority":2,"issue_type":"task","owner":"botbox-dev","created_at":"2026-02-02T21:03:34.531642156Z","created_by":"botbox-dev","updated_at":"2026-02-02T21:28:59.344953449Z","closed_at":"2026-02-02T21:28:59.344926058Z","close_reason":"Completed: Updated hook registration with --claim-owner, fixed immediate exit by adding fallback to stake","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":57,"issue_id":"bd-3uf","author":"botbox-dev","text":"Progress: Updated code to use --claim-owner flag\n\nChanges made:\n1. init.mjs:318 - Added --claim-owner ${agent} to hook registration\n2. agent-loop.sh:78-82 - Changed from stake to refresh for agent:// claim\n3. dev-loop.sh:107-111 - Changed from stake to refresh for agent:// claim\n4. reviewer-loop.sh:78-82 - Changed from stake to refresh for agent:// claim\n\nVerified spawn-security-reviewer.sh doesn't need changes (manual spawn, not hook-based).\n\nWorkflow docs don't need updates - they don't document the agent:// claim lifecycle (only bead:// and workspace://).\n\nNext: Run tests, verify the changes work correctly.","created_at":"2026-02-02T21:11:26Z"},{"id":58,"issue_id":"bd-3uf","author":"botbox-dev","text":"Completed by botbox-dev\n\nAll changes implemented and tested:\n- init.mjs now passes --claim-owner to hook registration\n- Loop scripts (agent, dev, reviewer) now refresh instead of staking agent:// claim\n- All 100 tests pass\n- Bash syntax validated\n- Commit described: 0fb1fe44\n\nThe hook-based claim lifecycle now works end-to-end: hook creates claim with --claim-owner, agent refreshes at startup.","created_at":"2026-02-02T21:12:03Z"},{"id":59,"issue_id":"bd-3uf","author":"botbox-dev","text":"Also registered botbox hook with --claim-owner: hk-xpt","created_at":"2026-02-02T21:13:20Z"},{"id":60,"issue_id":"bd-3uf","author":"botbox-dev","text":"Fixed immediate exit issue: Changed from refresh-only to refresh-with-fallback\n\nThe problem: bus claims refresh requires an existing claim. When the hook spawns the script, the claim might not be visible yet to the spawned process.\n\nSolution: Try refresh first (for hook-spawned cases where claim exists), fall back to stake if refresh fails (for manual-spawned or timing issues).\n\nThis handles both hook-spawned and manual invocation gracefully.\n\nUpdated terseid hook (hk-vjc) and botbox hook (hk-xpt) with --claim-owner.","created_at":"2026-02-02T21:28:55Z"}]}
{"id":"bd-80l","title":"Update review-response.md: include workspace path in re-request announcement","description":"When the author re-requests review after fixing issues, the botbus announcement should include the workspace path so the reviewer knows where to find the fixed code.\n\nCurrent: botbus send ... 'Review feedback addressed: <review-id>' -L review-response\nProposed: botbus send ... 'Review feedback addressed: <review-id> — fixes in workspace <ws-name> (<ws-path>)' -L review-response\n\nThis is the prompt-level fix for the workspace visibility gap discovered in R4-1 Phase 4. The tool-level fixes are tracked in botcrit (bd-2do, bd-2r4).\n\nAlso update the re-review prompt guidance in eval-review.md R4 section to document this pattern.\n\nAcceptance criteria:\n- review-response.md step 3d includes workspace path in botbus message\n- Re-review prompts can reference the workspace from the botbus message\n\nTesting: bun test (doc hash changes)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-31T19:59:39.488974532Z","created_by":"bob","updated_at":"2026-01-31T20:14:11.572853215Z","closed_at":"2026-01-31T20:14:11.572827036Z","close_reason":"Updated review-response.md step 3d to include workspace path in botbus announcement","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-dbz","title":"Validate CLI flag inputs (tools, type, reviewers)","description":"init.mjs accepts any string for --tools, --type, --reviewers without validation. Typos like --tools beadz silently produce broken AGENTS.md. Validate against PROJECT_TYPES, AVAILABLE_TOOLS, REVIEWER_ROLES constants. Error with clear message on invalid values.","status":"closed","priority":0,"issue_type":"bug","created_at":"2026-01-29T17:33:14.309172744Z","created_by":"bob","updated_at":"2026-01-29T17:34:42.882790930Z","closed_at":"2026-01-29T17:34:42.882767516Z","close_reason":"Completed","source_repo":".","compaction_level":0,"original_size":0,"labels":["must-fix","review-finding"]}
{"id":"bd-e29","title":"Strengthen progress comment requirement","description":"Iteration 2 of agent-loop eval had grooming and completion comments but no Progress comment during implementation. Options: (1) stronger language in worker-loop.md, (2) add to finish.md checklist as a prerequisite for closing, (3) make br close warn if no progress comment exists. Currently says 'Add at least one progress comment' but gets skipped.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-30T14:23:47.448158913Z","created_by":"bob","updated_at":"2026-01-30T16:25:45.994104530Z","closed_at":"2026-01-30T16:25:45.994078040Z","close_reason":"Strengthened to 'must add' in worker-loop.md, added verification step to finish.md checklist","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-fxk","title":"R8v2: run Sonnet eval, score, write report","description":"Fresh r8-setup.sh, run r8-run.sh with CLAUDE_MODEL=sonnet. Score against v2 rubric (65pts). Write eval-results/2026-02-01-review-r8-run3-sonnet.md. Compare against R8-1 (v1 single-file, 54/65).","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-01T19:08:14.126333093Z","created_by":"bob","updated_at":"2026-02-01T19:21:47.774073567Z","closed_at":"2026-02-01T19:21:47.773989158Z","source_repo":".","compaction_level":0,"original_size":0,"labels":["eval"],"dependencies":[{"issue_id":"bd-fxk","depends_on_id":"bd-138","type":"blocks","created_at":"2026-02-01T19:08:26.466815989Z","created_by":"bob","metadata":"{}","thread_id":""},{"issue_id":"bd-fxk","depends_on_id":"bd-gei","type":"blocks","created_at":"2026-02-01T19:08:30.700780115Z","created_by":"bob","metadata":"{}","thread_id":""}],"comments":[{"id":7,"issue_id":"bd-fxk","author":"Bob","text":"Sonnet scored 41/65 (63%) — FAIL. Found Bug 1 (race, 12/12) but MISSED Bug 2 (TOCTOU, 0/12) — reviewer stated delete 'correctly uses canonicalize' when it doesn't. Missed Bug 3 (pagination, 0/6). Quality perfect 10/10. Wrong crit agent (botbox-dev not nexus-phoenix). Multi-file split dropped Sonnet from 83% (v1) to 63% (v2). Report: eval-results/2026-02-01-review-r8-run3-sonnet.md","created_at":"2026-02-01T19:21:47Z"}]}
{"id":"bd-gdt","title":"Update eval verification to use botbus claims --since","description":"botbus v0.3.8 added --since flag to claims command. Update eval-loop.md verification methods to use 'botbus claims --agent $AGENT --since 1h' instead of bare 'botbus claims --agent $AGENT' for cleaner eval output. Also useful for filtering claims by session.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-30T16:05:43.426035899Z","created_by":"bob","updated_at":"2026-01-30T16:25:46.050386184Z","closed_at":"2026-01-30T16:25:46.050366257Z","close_reason":"Updated eval-loop.md shell-level checks to use botbus claims --since 1h","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-gei","title":"R8v2: verify fixture compiles (cargo check + clippy)","description":"Run r8-setup.sh, then verify cargo check and cargo clippy both pass clean on the 7-file fixture. This gates all eval runs.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-01T19:08:05.344218022Z","created_by":"bob","updated_at":"2026-02-01T19:11:06.956593852Z","closed_at":"2026-02-01T19:11:06.956523430Z","source_repo":".","compaction_level":0,"original_size":0,"labels":["eval"],"dependencies":[{"issue_id":"bd-gei","depends_on_id":"bd-138","type":"blocks","created_at":"2026-02-01T19:08:26.408729442Z","created_by":"bob","metadata":"{}","thread_id":""}]}
{"id":"bd-kng","title":"Update workflow docs: run br commands from default workspace only","description":"maw-dev confirmed that beads merge conflicts (.beads/issues.jsonl) are caused by agents running br commands from inside agent workspaces. Both the workspace and default modify the beads file, creating jj conflicts. Update worker-loop.md, start.md, and finish.md to instruct agents to run all br commands (br update, br close, br comments, br sync) from the default workspace context, not from .workspaces/$WS/. Use 'cd $PROJECT_ROOT && br ...' or 'maw ws jj default -- ...' pattern.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-30T16:05:43.281798973Z","created_by":"bob","updated_at":"2026-01-30T16:25:45.871893867Z","closed_at":"2026-01-30T16:25:45.871871134Z","close_reason":"Added br-from-project-root guidance to worker-loop.md, start.md, finish.md, and agent-loop.sh prompt","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-l3w","title":"Waiting on maw: merge doesn't rebase default onto work commits","description":"Filed feedback in #maw. After maw ws merge <ws> --destroy -f, work commits exist in jj but default's working copy isn't descended from them. Project root ends up empty.\n\nDiscovered during eval run 6 (Sonnet). Agent followed protocol correctly — this is a maw ws merge behavior issue.\n\nEnv: /tmp/tmp.9NpmXrdq5A\nBotbus message: sent to #maw with -L feedback\n\nBlocked on: maw-dev response","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-29T23:39:16.734038768Z","created_by":"bob","updated_at":"2026-01-29T23:55:11.956733903Z","closed_at":"2026-01-29T23:55:11.956709237Z","close_reason":"Fixed in maw v0.8.0","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-n6d","title":"E2E: --force vs no --force","description":"Test 8 from testing.md — verify overwrite protection and --force override","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-29T18:39:18.902167795Z","created_by":"bob","updated_at":"2026-01-29T18:42:48.498193281Z","closed_at":"2026-01-29T18:42:48.498169877Z","close_reason":"done","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-p1j","title":"Add AGENTS.md with mesh protocol guidance","description":"Document mesh protocol usage, agent identity, and beads workflow for this repo.","status":"closed","priority":2,"issue_type":"docs","created_at":"2026-01-26T23:29:00.647099983Z","created_by":"bob","updated_at":"2026-01-26T23:29:50.034736846Z","closed_at":"2026-01-26T23:29:50.034660744Z","source_repo":".","compaction_level":0,"original_size":0}
{"id":"bd-ppt","title":"Advanced eval: multi-agent coordination, dispatch, planning, adversarial, recovery","description":"Next-generation evals beyond R4. Tests advanced agent behaviors: cross-project coordination, parallel worker dispatch, epic planning/decomposition, adversarial review (subtle bugs), and failure recovery. Each subtask is an independent eval level that can be run standalone. Builds on the R1-R4 framework (bd-110) and extends the launcher script pattern.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-31T23:42:06.805120419Z","created_by":"bob","updated_at":"2026-02-02T14:15:25.294635016Z","closed_at":"2026-02-02T14:15:25.294613736Z","close_reason":"All subtasks completed","source_repo":".","compaction_level":0,"original_size":0,"labels":["epic","eval"],"comments":[{"id":9,"issue_id":"bd-ppt","author":"Bob","text":"R8 learnings for all future evals: (1) Multi-file fixtures are strictly harder than single-file — Sonnet dropped from 83% to 63% on the same bugs. Use multi-file in all future eval fixtures. (2) Doc-referenced prompts (agent reads .agents/botbox/*.md) instead of inline prompts — tests protocol compliance and keeps evals in sync with workflow changes. Shipped in r8-run.sh v3. (3) v2 FP rules (only penalize HIGH+ or block citation) are better calibrated — adopt for all review scoring.","created_at":"2026-02-01T19:43:44Z"},{"id":22,"issue_id":"bd-ppt","author":"Bob","text":"Grooming note: This epic has 5 subtasks (R5-R9), of which 2 are complete (R7, R8). The remaining 3 (R5, R6, R9) all depend on this epic, but the epic itself has no implementation work — it's purely organizational. Recommendation: Close this epic as 'organizational complete' since the subtasks are well-defined, or reverse the dependencies so the epic depends on its subtasks (more typical epic modeling). The current structure blocks all remaining work because subtasks wait on an epic with no actionable content.","created_at":"2026-02-01T23:27:05Z"},{"id":25,"issue_id":"bd-ppt","author":"Bob","text":"Epic organizational work complete: All 5 subtasks (R5-R9) are well-defined and ready. R7 (bd-2dx) and R8 (bd-138) are already closed. The remaining 3 subtasks (R5/bd-2s1, R6/bd-2rb, R9/bd-3sy) have clear descriptions, acceptance criteria, and can be executed independently. This epic has no implementation work of its own - it was purely organizational to group the advanced eval levels. Closing as complete per grooming note.","created_at":"2026-02-01T23:33:04Z"},{"id":46,"issue_id":"bd-ppt","author":"Bob","text":"All 5 subtasks complete: R5 70/70, R6 69/70, R7 76/95, R8 49/65 (Opus), R9 69/70. 27 eval runs total across the framework.","created_at":"2026-02-02T14:15:25Z"}]}
{"id":"bd-qzg","title":"Add bus whoami check to identity steps","description":"Add guidance to run 'bus whoami --agent 1' before adopting an identity in worker-loop.md, start.md, and preflight.md.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-01T22:34:29.491092161Z","created_by":"bob","updated_at":"2026-02-01T22:43:39.154681379Z","closed_at":"2026-02-01T22:43:39.154664718Z","close_reason":"Completed","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":15,"issue_id":"bd-qzg","author":"Bob","text":"Added bus whoami guidance in worker-loop.md identity section and start.md/preflight.md identity steps.","created_at":"2026-02-01T22:43:36Z"}]}
{"id":"bd-ugh","title":"cli: ctrl+c on prompt shows bad message","description":"❯ botbox init? Project name:57 |             reject(new ExitPromptError(`User force closed the prompt with ${code} ${signal}`));58 |         }));59 |         // SIGINT must be explicitly handled by the prompt so the ExitPromptError can be handled.60 |         // Otherwise, the prompt will stop and in some scenarios never resolve.61 |         // Ref issue #174162 |         const sigint = () => reject(new ExitPromptError(`User force closed the prompt with SIGINT`));                                         ^ExitPromptError: User force closed the prompt with SIGINT      at sigint (/home/bob/src/botbox/packages/cli/node_modules/@inquirer/core/dist/esm/lib/create-prompt.js:62:37)      at emit (node:events:92:22)      at [_ttyWrite] (node:readline:960:22)      at onKeyPress (node:readline:476:22)      at emit (node:events:98:22)      at emitKeys (node:readline:335:18)      at onData (node:readline:426:44)      at emit (node:events:95:22)      at addChunk (internal:streams/readable:265:47)      at readableAddChunkPushByteMode (internal:streams/readable:243:18)","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-29T22:15:52.502856973Z","created_by":"bob","updated_at":"2026-01-31T21:08:48.626451917Z","closed_at":"2026-01-31T21:08:48.626428403Z","close_reason":"Wrapped init prompts in try-catch to handle ExitPromptError from Ctrl+C gracefully, shows 'Initialization cancelled' instead of stack trace.","source_repo":".","compaction_level":0,"original_size":0,"labels":["cli"],"comments":[{"id":3,"issue_id":"bd-ugh","author":"Bob","text":"Note: this is a CLI UX bug, not workflow-related. When user hits ctrl+c during an inquirer prompt, the error message is unhelpful. Low priority relative to eval work.","created_at":"2026-01-30T00:02:58Z"}]}
{"id":"bd-wec","title":"R8v2: commit all changes via jj","description":"Final commit of all R8v2 work: fixture, rubric, eval reports, results tables, CLAUDE.md. Use jj describe + jj new.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-01T19:08:22.641272520Z","created_by":"bob","updated_at":"2026-02-01T19:22:50.235899196Z","closed_at":"2026-02-01T19:22:50.235828704Z","source_repo":".","compaction_level":0,"original_size":0,"labels":["eval"],"dependencies":[{"issue_id":"bd-wec","depends_on_id":"bd-138","type":"blocks","created_at":"2026-02-01T19:08:26.529401792Z","created_by":"bob","metadata":"{}","thread_id":""},{"issue_id":"bd-wec","depends_on_id":"bd-1gy","type":"blocks","created_at":"2026-02-01T19:08:30.791224407Z","created_by":"bob","metadata":"{}","thread_id":""}]}
{"id":"bd-wil","title":"make project type selection multiple-choice","description":"I have several projects that contain multiple types in the categories we list (cli and tui).","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-31T21:07:36.877794577Z","created_by":"bob","updated_at":"2026-01-31T21:08:48.586777773Z","closed_at":"2026-01-31T21:08:48.586749871Z","close_reason":"Changed project type selection from single-choice to multiple-choice (checkbox). Users can now select multiple types like 'api' + 'cli'.","source_repo":".","compaction_level":0,"original_size":0,"labels":["cli"]}
{"id":"bd-ztw","title":"Update root and eval docs to use bus CLI","description":"Update CLAUDE.md, AGENTS.md, eval-review.md, and other non-workflow docs to use bus for CLI commands where appropriate.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-01T22:34:25.436321956Z","created_by":"bob","updated_at":"2026-02-01T22:43:22.387753460Z","closed_at":"2026-02-01T22:43:22.387731229Z","close_reason":"Completed","source_repo":".","compaction_level":0,"original_size":0,"comments":[{"id":14,"issue_id":"bd-ztw","author":"Bob","text":"Updated root and eval docs (README.md, eval-review.md, eval-loop.md, docs/dev-agent-architecture.md, AGENTS.md) to use bus for CLI commands and tool lists.","created_at":"2026-02-01T22:43:19Z"}]}
