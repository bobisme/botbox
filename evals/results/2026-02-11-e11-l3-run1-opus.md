# E11-L3 Run 1: Botty-Native Full Lifecycle

**Date:** 2026-02-11
**Alpha-dev model:** Opus 4.6
**Alpha-security model:** Opus 4.6
**Beta-dev model:** Opus 4.6 (via respond.mjs → dev-loop.mjs)
**Workflow Score:** 133/140 (95%)
**Result:** EXCELLENT

## Tool Versions

| Tool | Version |
|------|---------|
| botbox | 0.6.1 |
| bus | 0.30.2 |
| br | 0.1.13 |
| maw | 0.31.2 |
| crit | 0.18.1 |
| botty | 0.12.2 |
| jj | 0.38.0 |
| cargo | 1.93.0 |

## Timing

| Event | Elapsed |
|-------|---------|
| alpha-dev spawned | 30s |
| beta-dev spawned (cross-project) | 210s |
| alpha-security spawned (review) | 301s |
| Alpha bead closed | 542s |
| Total wall clock | 641s (~10.7 min) |

## Phase Scores

| Check | Max | Score | Notes |
|-------|-----|-------|-------|
| **Spawn Chain** | **25** | **25** | |
| Alpha router hook fired | 5 | 5 | respond.mjs → dev-loop |
| Beta-dev spawned | 5 | 5 | Triggered by cross-project bus send |
| Alpha-security spawned | 5 | 5 | Triggered by @alpha-security mention |
| Spawn order | 5 | 5 | alpha-dev → beta-dev → alpha-security |
| Clean exit | 5 | 5 | All three agents exited cleanly |
| **Cross-Project Coordination** | **30** | **30** | |
| Bug discovery | 5 | 5 | Found validate_email rejects + |
| #projects query | 3 | 3 | Queried project registry |
| Cross-project message | 5 | 5 | Sent bug report to beta channel |
| Beta-dev investigated | 5 | 5 | Read code, identified the char whitelist |
| Beta validate_email fixed | 5 | 5 | Added + to allowed chars, test passes |
| Beta announced fix | 4 | 4 | Announced on beta channel |
| Tracking bead | 3 | 3 | Created local tracking bead |
| **Protocol Compliance** | **25** | **25** | |
| Bead transitions | 5 | 5 | open → in_progress → closed |
| Progress comments | 3 | 3 | 6 comments on alpha bead |
| Workspace management | 3 | 3 | Created and merged, no leaked workspaces |
| Claims released | 4 | 4 | All claims released |
| Bus labels | 5 | 5 | task-claim, review-request, review-done, task-done |
| br sync | 2 | 2 | Called br sync --flush-only |
| Channel announcements | 3 | 3 | Start, progress, completion messages |
| **Review Cycle** | **30** | **30** | |
| Review created | 3 | 3 | crit reviews create from workspace |
| Review requested | 3 | 3 | @alpha-security mention |
| Reviewer read from workspace | 3 | 3 | Read ws/crystal-kernel/src/main.rs |
| Reviewer found /debug | 5 | 5 | Found CRITICAL hardcoded secret + HIGH debug endpoint |
| Reviewer BLOCKed | 3 | 3 | Blocked with 1 CRITICAL, 1 HIGH, 2 MEDIUM, 1 LOW |
| Alpha-dev fixed /debug | 3 | 3 | Removed /debug, removed hardcoded secret |
| Re-requested review | 2 | 2 | Sent @alpha-security re-review request |
| Reviewer re-reviewed | 3 | 3 | Re-read source, verified all 4 fixes |
| Reviewer LGTMd | 3 | 3 | Approved after verifying fixes |
| Review marked merged | 2 | 2 | crit reviews mark-merged |
| **Code Correctness** | **20** | **20** | |
| Alpha cargo check | 5 | 5 | Compiles clean |
| POST /users endpoint | 3 | 3 | Endpoint exists and handles create_user |
| /debug fixed | 5 | 5 | No /debug route, no api_secret in code |
| Beta cargo test | 3 | 3 | 7/7 tests pass including test_plus_addressing |
| Beta allows + | 4 | 4 | validate_email("user+tag@example.com") → Ok |
| **Friction** | **10** | **3** | |
| Tool errors | 5 | 0 | 9 errors (threshold ≤5) |
| --help lookups | 3 | 2 | 1 lookup |
| Retry attempts | 2 | 1 | 1 retry |
| **Total** | **140** | **133** | |

## Critical Fail Conditions

- [x] Alpha merges while review BLOCKED — OK (did not merge while blocked)
- [x] No cross-project message to beta channel — OK (message sent)
- [x] /debug still exposes api_secret after fix — OK (removed entirely)
- [x] Missing --agent/--actor on mutating commands — OK (present)
- [x] Claims unreleased — OK (all released)

## Friction Analysis

9 tool errors from alpha-dev:
1. **"Not a crit repository"** (×2) — Ran `crit` in default workspace; should use agent workspace
2. **`crit reviews requests`** — Typo; correct subcommand is `request` (singular)
3. **`bus inbox --show-content`** — Flag doesn't exist
4. **`jj tag create`** — Should be `jj tag set`
5. **Push failed** — No remote configured (expected in eval; not an agent error)
6. **Exit code 2** (×2) — Minor CLI argument errors

**Root cause**: Most friction is from agents guessing CLI syntax. The crit workspace confusion (2/9 errors) is a real usability gap — agents don't always know which workspace context to use for crit commands.

## Key Findings

- **First-ever botty-native three-agent eval completed.** All agents spawned via hooks → botty → loop scripts. No manual `claude -p` invocations.
- **Cross-project coordination worked organically.** Alpha-dev discovered the beta bug during implementation, looked up the project registry, and sent a message to the beta channel — triggering beta-dev's router hook automatically.
- **Review cycle completed autonomously.** Alpha-dev created review, security reviewer blocked with 5 findings, alpha-dev fixed all issues, security re-reviewed and LGTMd.
- **Beta-dev completed a full dev cycle** including version bump (0.1.0 → 0.1.1), tag, and release announcement.
- **Alpha-dev completed full finish cycle** including merge, close, claims release, sync, and version bump (0.1.0 → 0.2.0).
- **Security reviewer was thorough.** Found the planted /debug vulnerability and also identified 3 additional real issues (mutex poisoning, unbounded memory, error string passthrough).

## Learnings

- **Verify script: check channel history, not just agent logs.** `botty tail` only returns the last session. When alpha-security was spawned twice (initial review + re-review), the first session's BLOCK was lost from agent log but preserved in channel history. Fixed verify script to check both.
- **Run script: capture incremental logs.** Added session-tracking to capture agent logs when they transition from running → not-running, preventing log loss on re-spawn.
- **Setup ordering matters.** Beta `botbox init` (maw init) must happen AFTER alpha's `cargo check`, since maw init moves Cargo.toml to ws/default/. Fixed to compile both projects before initializing either.
- **crit workspace context is a friction source.** Agents often try `maw exec default -- crit` instead of `maw exec $WS -- crit`. The AGENTS.md instructions say to use workspace context but agents still get confused when switching between br (always default) and crit (always workspace).
